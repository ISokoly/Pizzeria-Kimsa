<div class="products-container">
  <h2 class="title">{{ nombreCategoria }}</h2>

  <div class="products-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 16px;">
    <div class="product-item" *ngFor="let producto of productos">
      <h3 class="product-name">
        {{ producto.nombre }}
      </h3>
      @if (producto.imagen) {
        <img [src]="producto.imagen" alt="Imagen del producto" width="300" class="preview-img">
      }
      <p class="product-description">
        {{ producto.descripcion }} - ${{ producto.precio }}
      </p>
      <div class="actions">
        <button (click)="editProducto(producto)" class="edit-btn">Editar</button>
        <button (click)="deleteProducto(producto.id)" class="delete-btn">Eliminar</button>
      </div>
    </div>
  </div>
</div>  

<button class="create-btn" (click)="abrirFormularioProducto()">Crear Nuevo Producto</button>

<div *ngIf="mostrarFormularioProducto" class="overlay" (click)="cerrarFormularioProducto()"></div>

<div *ngIf="mostrarFormularioProducto" class="form-modal">
<div class="form-container">
  <h2 class="form-title">Productos</h2>
  
  <form (ngSubmit)="saveProducto()" class="form">
    <input 
      type="text" 
      [(ngModel)]="formData.nombre" 
      name="nombre" 
      placeholder="Nombre del producto" 
      required
      class="form-input"
    >

    <textarea 
      [(ngModel)]="formData.descripcion" 
      name="descripcion" 
      placeholder="Descripción" 
      required
      class="form-input"
    ></textarea>

    <select 
    [(ngModel)]="formData.id_categoria" 
    name="id_categoria" 
    required
    class="form-select"
  >
    <option value="" disabled>Seleccione una categoría</option>
    <option *ngFor="let categoria of categorias" [ngValue]="categoria.id" [selected]="categoria.id === formData.id_categoria">
      {{ categoria.nombre }}
    </option>
  </select>

    <div class="price-container">
      <label for="precio" class="label-text">Precio:</label>
      <input 
        id="precio"
        type="number" 
        [(ngModel)]="formData.precio" 
        name="precio" 
        required
        class="form-input w-full"
      >
    </div>

    <div class="price-container">
      <label for="imagen" class="label-text">Imagen:</label>
      <input 
        type="file" 
        (change)="onFileSelected($event)"
        accept="image/*"
        class="input-field">    
    </div>

    <button type="submit" class="submit-btn">
      {{ selectedProducto ? 'Actualizar' : 'Crear' }}
    </button>

    <button 
      *ngIf="selectedProducto" 
      type="button" 
      (click)="cancelEditProducto()" 
      class="cancel-btn"
    >
      Cancelar
    </button>

  </form>
</div>
</div>